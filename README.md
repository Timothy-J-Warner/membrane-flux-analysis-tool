# Permeance Analysis Software

## Table of Contents

- About The Project
  -Built With
- Features
- Installation
  - Prerequisites
  - Installation Steps
- Usage
- Configuration
- Contributing
- License
- Contact
- Acknowledgements

## About The Project

The program was written to rapidly calculate the water flux of hollow fiber membranes from time-mass data generated by
data-logging load cells, input values describing the properties of the membranes, and specified test conditions
including time at which the flux testing window should begin and the test pressure at the test time. The program 
converts mass to volume based on test room temperature and Kell's equation, applies data smoothing to reduce 
fluctuations in the volume data calculated from the load cells then uses changes in volume and 
properties on the membranes to calculate flux based on specified test conditions.

It currently has the following limitations and known bugs:
- Time-mass data must be 1 measurement per second.
- The time-mass data files must be named 'Channel_0.csv', 'Channel_1.csv', etc.
- Units of inputs have limited choices and output units are set
- Pressure measurement must be recorded during the experiment manually to be included in the test conditions file.
- If there are multiple or no mass values for a specified test time the program will error but a descriptive error
message will occur

### Built With

- [Python](https://www.python.org/) - A high-level programming language used for general-purpose programming.

## Features

- Feature 1: Reading time-mass data, inputs and test conditions from .csv files.
- Feature 2: Applying data smoothing to the mass values.
- Feature 3: Finding mass values at the start and end of the specified test windows.
- Feature 4: Calculating flux from changes in mass and membrane properties.
- Feature 5: Generating outputs.csv file from analysis results.

## Getting Started

### Prerequisites

Python 3.7+
numpy
pandas

### Installation

Obtain access to the private GitHub project from Timothy Warner

## Usage

- Update the files constants.csv, test_conditions.csv and config.csv
- Ensure there are data files for analysis and the file name and path match the code.
- Run the python code
- Flux data stored in outputs.csv


## Configuration

constants.csv file contains:
  - Flat sheet area (m^2). Only utilized when flat sheet membrane is selected
  - Hollow fiber membrane length (Length (cm)). Only utilized when hollow fiber membrane is selected
  - Hollow fiber membrane outside diameter (Diameter (mm)). Only utilized when hollow fiber membrane is selected
  - Number of membranes tested simultaneously (number of membranes flowing to a single load cell)
  - The length of time over which the mass change will be measured for flux calculations (Test Duration (s))
  - The temperature of the room at which the test took place

Flat sheet area (m^2),  Fiber Length (cm),  Fiber Diameter (mm),    Number of membranes per load cell,  Test Duration (s),  Test Temperature (C)
0.00125663706,          10.0,               1.2,                    1,                                 60,                  22.0


test_conditions.csv file contains:
  - The time at which the mass change measurement begins (Measurement Start time (24hr time))
  - The transmembrane pressure at which the experiment is taking place (Pressure (PSI))

Format:
Measurement Start time (24hr time),Pressure
19:23:00, 				            19.5
18:56:00,			             	29.7
18:31:00,				            39.7
18:05:00,				            50.0

config.csv file contains:
  - Membrane type. Flat sheet and hollow fiber membranes should be labels FS and HF respectively.
  - Number of load cells used to collect data
  - Input pressure unit (bar or PSI or MPa)
  - Data smoothing interval (s). The time interval over which the mass/volume data is smoothed to reduce noise

Format:
Membrane type (HF or FS),   Number of load cells,   Input pressure unit (bar or PSI or MPa),Data smoothing interval (s)
HF,                         3,                      PSI,                                    10

The time-mass data files must be named 'Channel_0.csv', 'Channel_1.csv', etc. and placed in the folder
'Data'. The time data column must contain a time formatted HH:MM:SS but does not matter if a date or fractional
second is included or not. There must be exactly 1 mass measurement per second or an error may occur or testing interval
will be inaccurate.

Format:
Date,Weight [Bridge Input Ch:0 -> 1046 S/N:583686]
2024-05-06 17:48:10.060226,284.226583810652
2024-05-06 17:48:11.060226,284.228423359392
2024-05-06 17:48:12.060226,284.199012290971
2024-05-06 17:48:13.060226,284.176953496213
2024-05-06 17:48:14.060226,284.219231536988
2024-05-06 17:48:15.060226,284.156732276431
2024-05-06 17:48:16.060226,284.140188180363
2024-05-06 17:48:17.060226,284.147542427792
2024-05-06 17:48:18.060226,284.145702879053
2024-05-06 17:48:19.060226,284.221071085728

## Contributing

Contact Timothy Warner to contribute.

## Roadmap

- [x] Development of minimum viable code to calculate flux based on the provided data and inputs
- [ ] Graphical user interface (GUI)
    - [ ] Modify inputs file based on GUI
    - [ ] Select data files for analysis
    - [ ] Run button for the script
    - [ ] (Optional) – provide additional setting such as:
      - [ ] Choosing between flat sheet and hollow fiber membrane
      - [ ] Choosing the number of data files to read and analyse – between 1 and 9 files
      - [ ] Choosing input and output units – metric vs imperial
- [ ] Improved functionality
    - [ ] Linear regression of flux values to calculate permeance of each data set
    - [ ] Plotting of flux vs pressure
      - [ ] Generating to copy-paste
      - [ ] Saving of image files
    - [x] Generation of useful test statistics
    - [ ] Generalising the code, so it can function with different time intervals and different rolling average windows.
    - [x] Allow for the addition of pressure data logging
- [ ] Quality Control
  - [x] Eliminated known bug when time values are missing from the raw data.
  - [ ] Ensure the code functions as expected.
  - [ ] Provide useful error messages and guide users to error free use of the software.
- [ ] Packaging of code to standalone application
    - [ ] Generate .exe so the program can be run without installing python
    - [ ] Ensure the standard of the code is high and fit to be published on GitHub and subsequent software journals including organised documentation and sufficient quality control and de-bugging


## Contact

Timothy Warner - warnet2@mcmaster.ca

## Acknowledgements

- Project contributors: Timothy Warner, Negar Takhsha
- [Python](https://www.python.org/) - A high-level programming language used for general-purpose programming.
- [NumPy](https://numpy.org/) - A fundamental package for scientific computing with Python.
- [pandas](https://pandas.pydata.org/) - A powerful data analysis and manipulation library for Python.
- [Matplotlib](https://matplotlib.org/) - A comprehensive library for creating static, animated, and interactive visualizations in Python.
